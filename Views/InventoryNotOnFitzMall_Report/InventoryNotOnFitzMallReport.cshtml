@model IEnumerable<WebApplication6.Models.InventoryNotOnFitzMall_Report>

@{
    ViewBag.Title = "NEW FitzMall.com SBOF Report";
    String prevLocation = "";
    long total_ShouldBeOnWebSite_1 = 0;
    long total_ShouldBeOnWebSite_2 = 0;
    long total_ShouldBeOnWebSite_4 = 0;
    long total_ShouldBeOnWebSite_9 = 0;
    long total_ShouldBeOnWebSite_12 = 0;
    long total_ShouldBeOnWebSite_14 = 0;

    long total_ActuallyOnWebSite_1 = 0;
    long total_ActuallyOnWebSite_2 = 0;
    long total_ActuallyOnWebSite_4 = 0;
    long total_ActuallyOnWebSite_9 = 0;
    long total_ActuallyOnWebSite_12 = 0;
    long total_ActuallyOnWebSite_14 = 0;

    long total_ShouldBeOnWebSite = 0;
    long total_ActuallyOnWebSite = 0;
    bool bPrintFormat = true;

}

<link href="~/Content/Site.css" rel="stylesheet" type="text/css">
<link href="~/Content/tableStyle.css" rel="stylesheet" type="text/css">

<h2 style="margin-left:11%">NEW FitzMall.com SBOF Report  @DateTime.Now.ToShortDateString()</h2>

    <table class="table" style="margin-left: 11%; width: 75%;position: sticky; top: 50px; margin-bottom: 0px" id="reportheaders">
        <thead class="thead">


            <tr>
                <th colspan="9" scope="colgroup" style="border-right-width: 4px">New Vehicles On FitzMall</th>
                <th colspan="8" scope="colgroup">New Vehicles That Should Be On FitzMall</th>
            </tr>

            <tr>
                <th colspan="2" scope="colgroup"></th>
                <th colspan="3" scope="colgroup" style="border-right-width: 4px">On The Ground</th>
                <th colspan="3" scope="colgroup">On Order</th>
                <th colspan="1" scope="colgroup" style="border-right-width: 4px"></th>
                <th colspan="3" scope="colgroup" style="border-right-width: 4px">On The Ground</th>
                <th colspan="3" scope="colgroup">On Order</th>
                <th colspan="1" scope="colgroup"></th>
            </tr>
            <tr>
                <th style="width: 9%">
                    Location
                </th>
                <th style="width: 11%">
                    Make
                </th>
                <th style="width: 4.5%">
                    1
                </th>
                <th style="width: 4.5%">
                    2
                </th>
                <th style="width: 4.5%; border-right-width: 4px">
                    4
                </th>
                <th style="width: 4.5%">
                    9
                </th>
                <th style="width: 4.5%">
                    12
                </th>
                <th style="width: 4.5%">
                    14
                </th>

                <th style="width: 6.75%; border-right-width: 4px; font-size:90%">
                    Total
                </th>

                <th style="width: 4.5%">
                    1
                </th>
                <th style="width: 4.5%">
                    2
                </th>
                <th style="width: 4.5%; border-right-width: 4px">
                    4
                </th>
                <th style="width: 4.5%">
                    9
                </th>
                <th style="width: 4.5%">
                    12
                </th>
                <th style="width: 4.5%">
                    14
                </th>
                <th style="width: 4.5%; font-size: 90%">
                    Total
                </th>
            </tr>
        </thead>
    </table>

    <table id="InvData" class="table" style="margin-left: 11%; width:75%">
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td style="width: 9%">

                        @{if (prevLocation != item.LOCATION)
                            {
                                @Html.DisplayFor(modelItem => item.LOCATION)
                            }

                            prevLocation = item.LOCATION;
                        }
                    </td>
                    <td style="width: 11%">
                        @Html.DisplayFor(modelItem => item.MAKE)
                    </td>
                    <td style="width: 4.5%">

                        @{ if ((item.ActuallyOnWebSite_1.Value == 0) ^ (bPrintFormat == false))
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_1.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_1.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "1", OnFitzMall = "1" })
                            }
                        }


                        @{
                            if (item.MAKE.Trim() != "")
                            {
                                total_ActuallyOnWebSite_1 += item.ActuallyOnWebSite_1.Value;
                            }
                        }

                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ActuallyOnWebSite_2.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_2.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_2.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "2", OnFitzMall = "1" })
                            }
                        }

                        @{
                            if (item.MAKE.Trim() != "")
                            {
                                total_ActuallyOnWebSite_2 += item.ActuallyOnWebSite_2.Value;
                            }
                        }

                    </td>
                    <td style="width: 4.5%; border-right-width: 4px">
                        @{ if (item.ActuallyOnWebSite_4.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_4.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_4.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "4", OnFitzMall = "1" })
                            }
                        }

                        @{
                            if (item.MAKE.Trim() != "")
                            {
                                total_ActuallyOnWebSite_4 += item.ActuallyOnWebSite_4.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ActuallyOnWebSite_9.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_9.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_9.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "9", OnFitzMall = "1" })
                            }
                        }

                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ActuallyOnWebSite_9 += item.ActuallyOnWebSite_9.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ActuallyOnWebSite_12.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_12.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_12.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "12", OnFitzMall = "1" })
                            }
                        }

                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ActuallyOnWebSite_12 += item.ActuallyOnWebSite_12.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ActuallyOnWebSite_14.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_14.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_14.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "14", OnFitzMall = "1" })
                            }
                        }

                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ActuallyOnWebSite_14 += item.ActuallyOnWebSite_14.Value;
                            }
                        }
                    </td>
                    <td style="width: 6.75%; border-right-width: 4px">

                        @{ if (item.ActuallyOnWebSite_TotalAllCarStat.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ActuallyOnWebSite_TotalAllCarStat.Value)
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ActuallyOnWebSite_TotalAllCarStat.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "0", OnFitzMall = "1" })
                            }
                        }



                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ShouldBeOnWebSite_1.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ShouldBeOnWebSite_1.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ShouldBeOnWebSite_1.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "1" })
                            }
                        }


                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite_1 += item.ShouldBeOnWebSite_1.Value;
                            }
                        }

                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ShouldBeOnWebSite_2.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ShouldBeOnWebSite_2.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ShouldBeOnWebSite_2.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "2" })
                            }
                        }

                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite_2 += item.ShouldBeOnWebSite_2.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%; border-right-width: 4px">

                        @{ if (item.ShouldBeOnWebSite_4.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ShouldBeOnWebSite_4.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ShouldBeOnWebSite_4.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "4" })
                            }
                        }

                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite_4 += item.ShouldBeOnWebSite_4.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ShouldBeOnWebSite_9.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ShouldBeOnWebSite_9.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ShouldBeOnWebSite_9.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "9" })
                            }
                        }
                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite_9 += item.ShouldBeOnWebSite_9.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ShouldBeOnWebSite_12.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ShouldBeOnWebSite_12.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ShouldBeOnWebSite_12.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "12" })
                            }
                        }
                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite_12 += item.ShouldBeOnWebSite_12.Value;
                            }
                        }
                    </td>
                    <td style="width: 4.5%">
                        @{ if (item.ShouldBeOnWebSite_14.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.ShouldBeOnWebSite_14.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.ShouldBeOnWebSite_14.Value, "DrillDown", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, StatusCode = "14" })
                            }
                        }
                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite_14 += item.ShouldBeOnWebSite_14.Value;
                            }
                        }
                    </td>
                    <td>
                        @{ if (item.FM_TotalAllCarStat.Value == 0)
                            {
                                @Html.DisplayFor(modelItem => item.FM_TotalAllCarStat.Value);
                            }
                            else
                            {
                                @Html.ActionLink("" + item.FM_TotalAllCarStat.Value, "DrillDown_AllStatusNew", new { StoreBranch = item.STOREBRANCH, Location = item.LOCATION, Make = item.MAKE, OnFitzMall = "0" })
                            }
                        }


                        @{ if (item.MAKE.Trim() != "")
                            {
                                total_ShouldBeOnWebSite += item.FM_TotalAllCarStat.Value;
                            }
                        }



                    </td>
                    @{ if (item.MAKE.Trim() != "")
                        {
                            total_ActuallyOnWebSite += Convert.ToInt32(item.ActuallyOnWebSite_TotalAllCarStat);
                        }
                    }
                </tr>

            }


            <tr>
                <td></td>
                <td></td>
                <td style="width: 4.5%">
                    @{ if (total_ActuallyOnWebSite_1 == 0)
                        {
                            @total_ActuallyOnWebSite_1;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ActuallyOnWebSite_1), "DrillDown", new { StoreBranch = "", Make = "", StatusCode = "1", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ActuallyOnWebSite_2 == 0)
                        {
                            @total_ActuallyOnWebSite_2;
                        }
                        else
                        {
                            @Html.ActionLink("" + total_ActuallyOnWebSite_2, "DrillDown", new { Make = "", StatusCode = "2", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>

                <td style="width: 4.5%; border-right-width: 4px">
                    @{ if (total_ActuallyOnWebSite_4 == 0)
                        {
                            @total_ActuallyOnWebSite_4;
                        }
                        else
                        {
                            @Html.ActionLink("" + total_ActuallyOnWebSite_4, "DrillDown", new { StoreBranch = "", Make = "", StatusCode = "4", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>

                <td style="width: 4.5%">
                    @{ if (total_ActuallyOnWebSite_9 == 0)
                        {
                            @total_ActuallyOnWebSite_9;
                        }
                        else
                        {
                            @Html.ActionLink("" + total_ActuallyOnWebSite_9, "DrillDown", new { StoreBranch = "", Make = "", StatusCode = "9", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ActuallyOnWebSite_12 == 0)
                        {
                            @total_ActuallyOnWebSite_12;
                        }
                        else
                        {
                            @Html.ActionLink("" + total_ActuallyOnWebSite_12, "DrillDown", new { StoreBranch = "", Make = "", StatusCode = "12", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ActuallyOnWebSite_14 == 0)
                        {
                            @total_ActuallyOnWebSite_14;
                        }
                        else
                        {
                            @Html.ActionLink("" + total_ActuallyOnWebSite_14, "DrillDown", new { StoreBranch = "", Make = "", StatusCode = "14", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%; border-right-width: 4px">
                    @{ if (total_ActuallyOnWebSite == 0)
                        {
                            @total_ActuallyOnWebSite;
                        }
                        else
                        {
                            @Html.ActionLink("" + total_ActuallyOnWebSite, "DrillDown", new { StoreBranch = "", Make = "", StatusCode = "ALL", OnFitzMall = "1", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ShouldBeOnWebSite_1 == 0)
                        {
                            @total_ShouldBeOnWebSite_1;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite_1), "DrillDown", new { Make = "", StatusCode = "1", OnFitzMall = "", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ShouldBeOnWebSite_2 == 0)
                        {
                            @total_ShouldBeOnWebSite_2;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite_2), "DrillDown", new { Make = "", StatusCode = "2", OnFitzMall = "", sortOrder = "" })
                        }
                    }

                </td>

                <td style="width: 4.5%;  border-right-width: 4px">
                    @{ if (total_ShouldBeOnWebSite_4 == 0)
                        {
                            @total_ShouldBeOnWebSite_4;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite_4), "DrillDown", new { Make = "", StatusCode = "4", OnFitzMall = "", sortOrder = "" })
                        }
                    }

                </td>

                <td style="width: 4.5%">
                    @{ if (total_ShouldBeOnWebSite_9 == 0)
                        {
                            @total_ShouldBeOnWebSite_9;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite_9), "DrillDown", new { Make = "", StatusCode = "9", OnFitzMall = "", sortOrder = "" })
                        }
                    }

                </td>

                <td style="width: 4.5%">
                    @{ if (total_ShouldBeOnWebSite_12 == 0)
                        {
                            @total_ShouldBeOnWebSite_12;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite_12), "DrillDown", new { Make = "", StatusCode = "12", OnFitzMall = "", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ShouldBeOnWebSite_14 == 0)
                        {
                            @total_ShouldBeOnWebSite_14;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite_14), "DrillDown", new { Make = "", StatusCode = "14", OnFitzMall = "", sortOrder = "" })
                        }
                    }

                </td>
                <td style="width: 4.5%">
                    @{ if (total_ShouldBeOnWebSite == 0)
                        {
                            @total_ShouldBeOnWebSite;
                        }
                        else
                        {
                            @Html.ActionLink("" + (total_ShouldBeOnWebSite), "DrillDown_AllStatusNew", new { StoreBranch = "", Make = "", StatusCode = "ALL", OnFitzMall = "", sortOrder = "" })
                        }
                    }


                </td>

            </tr>

    </table>

    @Html.ActionLink("Excel", "ExportToExcel")
